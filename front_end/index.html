<html>
    <head>
      <link rel="stylesheet" type="text/css" href="./styles/importedStyles.css" />
    </head>

    <body>
        <div id="page" style="width:100%;height:100%;position:fixed;top:0;left:0;"></div>
        <div id="loader-animation"  style="width:100%;height:100%;position:fixed;top:0;left:0;z-index:100"></div>
    </body>

    <script src="./javascript/require-config.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.2/require.min.js"></script>

    <script>

    require(['director', 'components', 'loader'], function () {

      function timeToHideLoader (time) {
        if (!time)
          time = 0;
        setTimeout(function () {
           $("#loader-animation").hide();
        }, time);
      }



      var loginPage = function () {
        $("#loader-animation").fadeIn();
        require(['config', 'onboarding'], function () {
          loadComponent("OnboardingFrontPage", $("#page"), function () {
            new Onboarding($('#page').find('.onboarding-page'));
            setTimeout(function () {
              $("#loader-animation").fadeOut();
            }, 500);
          });
        });
      };

      var onboardingCoursesPage = function(courses) {
        $("#loader-animation").show();
        loadComponentOrLogin("OnboardingCoursesModule", $("#page"), function () {
            require(['course-selection'], function () {
            new OnboardingCourses([], $("#page").find(".course-table"));
            $("#loader-animation").hide();
          });
        });
      }


        
      var podcast = function (podcastId) { 
        $("#loader-animation").show();
        loadComponentOrLogin("PodcastModule", $("#page"), function () {
          require(['podcast'], function () {
            new PodcastPage(podcastId, $("#page").find(".podcast-page-div"), 10);
            timeToHideLoader(1000);
          });
        });
      };

      var search = function (courseId) {
        $("#loader-animation").show();
        require(['searchResults'], function () {
          loadComponent("CourseSearchModule", $("#page"), function () {
            new SearchPage(courseId, $("#page").find(".search-results-div"));
            $("#loader-animation").hide();
          });
        });
      };

      var courseHomepage = function() {
        $("#loader-animation").show();
        loadComponent("CourseHomepageModule", $("#page"), function() {
          require(['course-homepage'], function() {
            new CourseHomepageClass(1, $("#page").find(".course-homepage-div"));
            $("#loader-animation").hide();
          });
        });
      }

      var routes = {
        '/podcast/:podcastId': podcast,
        '/search/:courseId': search,
        '/': loginPage,
        '': loginPage,
        '/course_homepage/:courseId': courseHomepage,
        '/courses': onboardingCoursesPage
      };

      var router = Router(routes);

      // Scripts above are required on every single page

      loadComponent("LoaderModule", $("#loader-animation"), function () {
        setTimeout(function () {
          router.init('/');
        }, 20);
      });
    });
    </script>
</html>
